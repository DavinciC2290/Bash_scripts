#!/bin/bash

test -f /usr/bin/git #comando test que comprueba la correcta ejecucion de un comando, si se ejecuta bien regresa un 0 si no regresa un #numero cualquiera
comprobacion_git=$(echo $?) # $? revisa el numero del comando que se ejecuto

test -f /usr/bin/searchsploit
comprobacion_searchsploit=$(echo $?)

function instalar_git(){
	apt install git -y
}

function instalar_searchsploit(){
	git clone https://gitlab.com/exploit-database/exploitdb.git && cd exploitdb/ && mv * /usr/bin && cd .. && rm -r exploitdb/
}

if test $comprobacion_searchsploit == "0" && test $comprobacion_git == "0"; then
	echo "Las dependencias estan instaladas"
	read -p "Escribe el programa a buscar exploits: " programa
	searchsploit $programa
	read -p "Escribe el exploit que quieras descargar: " exploit
	searchsploit -m $exploit

else
	echo "Hay que instalar dependencias"
	if test $comprobacion_git != "0"; then
		instalar_git
	fi

	if test $comprobacion_searchsploit != "0"; then
		instalar_searchsploit
	fi

	read -p "Escribe el programa a buscar exploits: " programa
	searchsploit $programa
	read -p "Escribe el exploit que quieras descargar: " exploit
	searchsploit -m  $exploit

fi
